import{r as t,f as e,g as r,u as n,d as o,h as a,i as s,j as i,k as c,l,v as u,n as h,p,c as d,q as f,w as m,S as g,x as v,o as w,y,z as b}from"./solid-DsUIy2vl.js";function L(){let t=new Set;let e=!1;return{subscribe:function(e){return t.add(e),()=>t.delete(e)},confirm:function(r,n){if(e)return!(e=!1);const o={to:r,options:n,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0};for(const a of t)a.listener({...o,from:a.location,retry:t=>{t&&(e=!0),a.navigate(r,{...n,resolve:!1})}});return!o.defaultPrevented}}}let P;function A(){window.history.state&&null!=window.history.state._depth||window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),P=window.history.state._depth}A();const E=/^(?:[a-z0-9]+:)?\/\//i,R=/^\/+|(\/)\/+$/g,S="http://sr";function U(t,e=!1){const r=t.replace(R,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function k(t,e,r){if(E.test(e))return;const n=U(t),o=r&&U(r);let a="";return a=!o||e.startsWith("/")?n:0!==o.toLowerCase().indexOf(n.toLowerCase())?n+o:o,(a||"/")+U(e,!a)}function x(t,e){return U(t).replace(/\/*(\*.*)?$/g,"")+U(e)}function C(t){const e={};return t.searchParams.forEach((t,r)=>{r in e?Array.isArray(e[r])?e[r].push(t):e[r]=[e[r],t]:e[r]=t}),e}function F(t,e,r){const[n,o]=t.split("/*",2),a=n.split("/").filter(Boolean),s=a.length;return t=>{const n=t.split("/").filter(Boolean),i=n.length-s;if(i<0||i>0&&void 0===o&&!e)return null;const c={path:s?"":"/",params:{}},l=t=>void 0===r?void 0:r[t];for(let e=0;e<s;e++){const t=a[e],r=":"===t[0],o=r?n[e]:n[e].toLowerCase(),s=r?t.slice(1):t.toLowerCase();if(r&&W(o,l(s)))c.params[s]=o;else if(r||!W(o,s))return null;c.path+=`/${o}`}if(o){const t=i?n.slice(-i).join("/"):"";if(!W(t,l(o)))return null;c.params[o]=t}return c}}function W(t,e){const r=e=>e===t;return void 0===e||("string"==typeof e?r(e):"function"==typeof e?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp&&e.test(t))}function O(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((t,e)=>t+(e.startsWith(":")?2:3),n.length-(void 0===r?0:1))}function j(n){const o=new Map,a=r();return new Proxy({},{get:(r,s)=>(o.has(s)||t(a,()=>o.set(s,e(()=>n()[s]))),o.get(s)()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),ownKeys:()=>Reflect.ownKeys(n())})}function _(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const o=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)o.push(r+=e[1]),n=n.slice(e[0].length);return _(n).reduce((t,e)=>[...t,...o.map(t=>t+e)],[])}const q=o(),I=o(),K=()=>function(t,e){if(null==t)throw new Error(e);return t}(n(q),"<A> and 'use' router primitives can be only used inside a Route."),T=()=>K().navigatorFactory();function $(t,e=""){const{component:r,preload:n,load:o,children:a,info:s}=t,i=!a||Array.isArray(a)&&!a.length,c={key:t,component:r,preload:n||o,info:s};return D(t.path).reduce((r,n)=>{for(const o of _(n)){const a=x(e,o);let s=i?a:a.split("/*",1)[0];s=s.split("/").map(t=>t.startsWith(":")||t.startsWith("*")?t:encodeURIComponent(t)).join("/"),r.push({...c,originalPath:n,pattern:s,matcher:F(s,!i,t.matchFilters)})}return r},[])}function B(t,e=0){return{routes:t,score:1e4*O(t[t.length-1])-e,matcher(e){const r=[];for(let n=t.length-1;n>=0;n--){const o=t[n],a=o.matcher(e);if(!a)return null;r.unshift({...a,route:o})}return r}}}function D(t){return Array.isArray(t)?t:[t]}function N(t,e="",r=[],n=[]){const o=D(t);for(let a=0,s=o.length;a<s;a++){const t=o[a];if(t&&"object"==typeof t){t.hasOwnProperty("path")||(t.path="");const o=$(t,e);for(const e of o){r.push(e);const o=Array.isArray(t.children)&&0===t.children.length;if(t.children&&!o)N(t.children,e.pattern,r,n);else{const t=B([...r],n.length);n.push(t)}r.pop()}}}return r.length?n:n.sort((t,e)=>e.score-t.score)}function V(t,e){for(let r=0,n=t.length;r<n;r++){const n=t[r].matcher(e);if(n)return n}return[]}let z;function M(r,o,u,d={}){const{signal:[f,m],utils:g={}}=r,v=g.parsePath||(t=>t),w=g.renderPath||(t=>t),y=g.beforeLeave||L(),b=k("",d.base||"");if(void 0===b)throw new Error(`${b} is not a valid base path`);b&&!f().value&&m({value:b,replace:!0,scroll:!1});const[P,A]=a(!1);let E;const R=(t,e)=>{e.value===U()&&e.state===F()||(void 0===E&&A(!0),z=t,E=e,h(()=>{E===e&&(x(E.value),W(E.state),q[1](t=>t.filter(t=>t.pending)))}).finally(()=>{E===e&&p(()=>{z=void 0,"navigate"===t&&function(t){const e=_[0];e&&(m({...t,replace:e.replace,scroll:e.scroll}),_.length=0)}(E),A(!1),E=void 0})}))},[U,x]=a(f().value),[F,W]=a(f().state),O=function(t,r,n){const o=new URL(S),a=e(e=>{const r=t();try{return new URL(r,o)}catch(n){return e}},o,{equals:(t,e)=>t.href===e.href}),s=e(()=>a().pathname),c=e(()=>a().search,!0),l=e(()=>a().hash),u=i(c,()=>C(a()));return{get pathname(){return s()},get search(){return c()},get hash(){return l()},get state(){return r()},get key(){return""},query:n?n(u):j(u)}}(U,F,g.queryWrapper),_=[],q=a([]),K=e(()=>"function"==typeof d.transformUrl?V(o(),d.transformUrl(O.pathname)):V(o(),O.pathname)),T=()=>{const t=K(),e={};for(let r=0;r<t.length;r++)Object.assign(e,t[r].params);return e},$=g.paramsWrapper?g.paramsWrapper(T,o):j(T),B={pattern:b,path:()=>b,outlet:()=>null,resolvePath:t=>k(b,t)};return s(i(f,t=>R("native",t),{defer:!0})),{base:B,location:O,params:$,isRouting:P,renderPath:w,parsePath:v,navigatorFactory:function(t){return t=t||n(I)||B,(e,r)=>function(t,e,r){c(()=>{if("number"==typeof e)return void(e&&g.go&&g.go(e));const n=!e||"?"===e[0],{replace:o,resolve:a,scroll:s,state:i}={replace:!1,resolve:!n,scroll:!0,...r},c=a?t.resolvePath(e):k(n&&O.pathname||"",e);if(void 0===c)throw new Error(`Path '${e}' is not a routable path`);if(_.length>=100)throw new Error("Too many redirects");const u=U();c===u&&i===F()||l||y.confirm(c,r)&&(_.push({value:u,replace:o,scroll:s,state:F()}),R("navigate",{value:c,state:i}))})}(t,e,r)},matches:K,beforeLeave:y,preloadRoute:function(e,r){const n=V(o(),e.pathname),a=z;z="preload";for(let o in n){const{route:a,params:s}=n[o];a.component&&a.component.preload&&a.component.preload();const{preload:i}=a;r&&i&&t(u(),()=>i({params:s,location:{pathname:e.pathname,search:e.search,hash:e.hash,query:C(e),state:null,key:""},intent:"preload"}))}z=a},singleFlight:void 0===d.singleFlight||d.singleFlight,submissions:q}}function J(t,r,n,o){const{base:a,location:s,params:i}=t,{pattern:c,component:l,preload:u}=o().route,h=e(()=>o().path);l&&l.preload&&l.preload();const p=u?u({params:i,location:s,intent:z||"initial"}):void 0;return{parent:r,pattern:c,path:h,outlet:()=>l?d(l,{params:i,location:s,data:p,get children(){return n()}}):n(),resolvePath:t=>k(a.path(),t,h())}}const G=t=>n=>{const{base:o}=n,a=f(()=>n.children),s=e(()=>N(a(),n.base||""));let i;const c=M(t,s,()=>i,{base:o,singleFlight:n.singleFlight,transformUrl:n.transformUrl});return t.create&&t.create(c),d(q.Provider,{value:c,get children(){return d(H,{routerState:c,get root(){return n.root},get preload(){return n.rootPreload||n.rootLoad},get children(){return[m(()=>(i=r())&&null),d(Q,{routerState:c,get branches(){return s()}})]}})}})};function H(t){const r=t.routerState.location,n=t.routerState.params,o=e(()=>t.preload&&c(()=>{t.preload({params:n,location:r,intent:z||"initial"})}));return d(g,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:e=>d(e,{params:n,location:r,get data(){return o()},get children(){return t.children}})})}function Q(t){const r=[];let n;const o=e(i(t.routerState.matches,(e,a,s)=>{let i=a&&e.length===a.length;const c=[];for(let n=0,l=e.length;n<l;n++){const l=a&&a[n],u=e[n];s&&l&&u.route.key===l.route.key?c[n]=s[n]:(i=!1,r[n]&&r[n](),v(e=>{r[n]=e,c[n]=J(t.routerState,c[n-1]||t.routerState.base,X(()=>o()[n+1]),()=>t.routerState.matches()[n])}))}return r.splice(e.length).forEach(t=>t()),s&&i?s:(n=c[0],c)}));return X(()=>o()&&n)()}const X=t=>()=>d(g,{get when(){return t()},keyed:!0,children:t=>d(I.Provider,{value:t,get children(){return t.outlet()}})});const Y=new Map;function Z(t=!0,e=!1,r="/_server",n){return o=>{const a=o.base.path(),s=o.navigatorFactory(o.base);let i,c;function l(t){if(t.defaultPrevented||0!==t.button||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return;const r=t.composedPath().find(t=>t instanceof Node&&"A"===t.nodeName.toUpperCase());if(!r||e&&!r.hasAttribute("link"))return;const n="http://www.w3.org/2000/svg"===r.namespaceURI;const o=n?r.href.baseVal:r.href;if((n?r.target.baseVal:r.target)||!o&&!r.hasAttribute("state"))return;const s=(r.getAttribute("rel")||"").split(/\s+/);if(r.hasAttribute("download")||s&&s.includes("external"))return;const i=n?new URL(o,document.baseURI):new URL(o);return i.origin!==window.location.origin||a&&i.pathname&&!i.pathname.toLowerCase().startsWith(a.toLowerCase())?void 0:[r,i]}function u(t){const e=l(t);if(!e)return;const[r,n]=e,a=o.parsePath(n.pathname+n.search+n.hash),i=r.getAttribute("state");t.preventDefault(),s(a,{resolve:!1,replace:r.hasAttribute("replace"),scroll:!r.hasAttribute("noscroll"),state:i?JSON.parse(i):void 0})}function h(t){const e=l(t);if(!e)return;const[r,a]=e;n&&(a.pathname=n(a.pathname)),o.preloadRoute(a,"false"!==r.getAttribute("preload"))}function p(t){clearTimeout(i);const e=l(t);if(!e)return c=null;const[r,a]=e;c!==r&&(n&&(a.pathname=n(a.pathname)),i=setTimeout(()=>{o.preloadRoute(a,"false"!==r.getAttribute("preload")),c=r},20))}function d(t){if(t.defaultPrevented)return;let e=t.submitter&&t.submitter.hasAttribute("formaction")?t.submitter.getAttribute("formaction"):t.target.getAttribute("action");if(!e)return;if(!e.startsWith("https://action/")){const t=new URL(e,S);if(e=o.parsePath(t.pathname+t.search),!e.startsWith(r))return}if("POST"!==t.target.method.toUpperCase())throw new Error("Only POST forms are supported for Actions");const n=Y.get(e);if(n){t.preventDefault();const e=new FormData(t.target,t.submitter);n.call({r:o,f:t.target},"multipart/form-data"===t.target.enctype?e:new URLSearchParams(e))}}b(["click","submit"]),document.addEventListener("click",u),t&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",h,{passive:!0}),document.addEventListener("touchstart",h,{passive:!0})),document.addEventListener("submit",d),w(()=>{document.removeEventListener("click",u),t&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",h),document.removeEventListener("touchstart",h)),document.removeEventListener("submit",d)})}}function tt(t){const e=()=>{const t=window.location.pathname.replace(/^\/+/,"/")+window.location.search,e=window.history.state&&window.history.state._depth&&1===Object.keys(window.history.state).length?void 0:window.history.state;return{value:t+window.location.hash,state:e}},r=L();return function(t){let e=!1;const r=t=>"string"==typeof t?{value:t}:t,n=function([t,e],r,n){return[t,n?t=>e(n(t)):e]}(a(r(t.get()),{equals:(t,e)=>t.value===e.value&&t.state===e.state}),0,r=>(!e&&t.set(r),y.registry&&!y.done&&(y.done=!0),r));return t.init&&w(t.init((o=t.get())=>{e=!0,n[1](r(o)),e=!1})),G({signal:n,create:t.create,utils:t.utils})}({get:e,set({value:t,replace:e,scroll:r,state:n}){e?window.history.replaceState(function(t){return{...t,_depth:window.history.state&&window.history.state._depth}}(n),"",t):window.history.pushState(n,"",t),function(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}(decodeURIComponent(window.location.hash.slice(1)),r),A()},init:t=>{return n=window,o="popstate",a=function(t,e){let r=!1;return()=>{const n=P;A();const o=null==n?null:P-n;r?r=!1:o&&e(o)?(r=!0,window.history.go(-o)):t()}}(t,t=>{if(t&&t<0)return!r.confirm(t);{const t=e();return!r.confirm(t.value,{state:t.state})}}),n.addEventListener(o,a),()=>n.removeEventListener(o,a);var n,o,a},create:Z(t.preload,t.explicitLinks,t.actionBase,t.transformUrl),utils:{go:t=>window.history.go(t),beforeLeave:r}})(t)}export{tt as R,T as u};
